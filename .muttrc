# Neomutt config for Gmail with OAuth2

# Account
set imap_user = "harper@nata2.org"
set folder = "imaps://imap.gmail.com:993"
set smtp_url = "smtp://harper@nata2.org@smtp.gmail.com:587/"

# OAuth2 authentication
set imap_authenticators = "oauthbearer:xoauth2"
set imap_oauth_refresh_command = "~/.mutt/mutt_oauth2.py ~/.mutt/harper@nata2.org.tokens"
set smtp_authenticators = "oauthbearer:xoauth2"
set smtp_oauth_refresh_command = "~/.mutt/mutt_oauth2.py ~/.mutt/harper@nata2.org.tokens"

# SSL/TLS
set ssl_force_tls = yes
set ssl_starttls = yes
set ssl_verify_dates = yes
set ssl_verify_host = yes

# Gmail folders
set spoolfile = "+INBOX"
set postponed = "+[Gmail]/Drafts"
set trash = "+[Gmail]/Trash"
set record = "+[Gmail]/Sent Mail"
set imap_check_subscribed

# Performance - caching is crucial for IMAP
set header_cache = "~/.mutt/cache/headers"
set message_cachedir = "~/.mutt/cache/bodies"
set imap_qresync = yes

# Mailboxes for sidebar
mailboxes "+INBOX" "+[Gmail]/Sent Mail" "+[Gmail]/Drafts" "+[Gmail]/Trash" "+[Gmail]/Starred"

# Sidebar - neomutt's killer feature
set sidebar_visible = yes
set sidebar_width = 25
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_short_path = yes
set sidebar_delim_chars = "/"
set sidebar_folder_indent = yes
set sidebar_indent_string = "  "
set mail_check_stats

# Sidebar bindings
bind index,pager \Cp sidebar-prev
bind index,pager \Cn sidebar-next
bind index,pager \Co sidebar-open
bind index,pager B sidebar-toggle-visible

# General settings
set hostname = nata2.org
set mail_check = 60
set timeout = 10
set beep = no
set realname = "Harper Reed"
set from = "harper@nata2.org"
set use_from = yes
set envelope_from = yes
set arrow_cursor
set implicit_autoview
auto_view text/html
set hidden_host
set reverse_name = yes
set send_charset = "utf-8"
set assumed_charset = "utf-8"
set charset = "utf-8"
set ascii_chars = yes
set fast_reply
set nomark_old
set nomarkers
set pager_context = 6
set pager_index_lines = 10
set nostrict_threads
set nopipe_decode
set text_flowed

unset move           # gmail does that
set delete           # don't ask, just do
unset confirmappend  # don't ask, just do!
set quit             # don't ask, just do!!
unset mark_old       # read/new is good enough for me

# sort/threading
set sort     = threads
set sort_aux = reverse-last-date-received
set sort_re

# look and feel
set menu_scroll
set smart_wrap
set tilde
unset markers


# composing 
set fcc_attach
unset mime_forward
set forward_format = "Fwd: %s"
set include
set forward_quote

ignore *                               # first, ignore all headers
unignore from: to: cc: date: subject:  # then, show only these
hdr_order from: to: cc: date: subject: # and in this order

# Index bindings
bind index ' ' next-page
bind index '-' previous-page
bind index c mail
bind index x sync-mailbox

# Vim-like navigation (unbind g first to allow gg)
bind index g noop
bind index j next-entry
bind index k previous-entry
bind index gg first-entry
bind index G last-entry
bind index gi change-folder
bind index gf imap-fetch-mail
bind index \Cd half-down
bind index \Cu half-up

# Pager bindings (unbind g first to allow gg)
bind pager g noop
bind pager ' ' next-page
bind pager '-' previous-page
bind pager c mail
bind pager j next-line
bind pager k previous-line
bind pager gg top
bind pager G bottom
bind pager gi change-folder

#color index     blue    default "~C USER"   # to or cc USER
#color index     red     default ~D          # deleted
#color index     green   default ~U          # unread
#color index     yellow  default ~T          # tagged
#color indicator black   yellow
#color message   black   red
#color quoted1   cyan    black
#color quoted2   yellow  black
#color quoted3   red     black
#color quoted4   green   black
#color quoted5   blue    black
#color quoted6   green   black
#color signature blue    black
#color status    blue    black
#color tree      cyan    black 

# Editor
set editor="vim +13 -c 'set nobackup' -c 'set noswapfile' -c 'set nowritebackup' -c 'set tw=72 ft=mail noautoindent'"

# PGP
source ~/.mutt/gpg.rc


#source ~/.mutt/mutt-colors-solarized-light-16.muttrc
source ~/.mutt/mutt-colors-solarized-dark-16.muttrc
#source ~/.mutt/mutt-colors-solarized-dark-256.muttrc


