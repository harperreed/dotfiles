##### PREFIX & SCREEN-LIKE BEHAVIOR #####

# Use Ctrl-a as prefix (screen-like)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Use Vi mode for copy + status
set -g mode-keys vi
set -g status-keys vi

# Enable mouse support
set -g mouse on

##### SPLITS & WINDOW MANAGEMENT #####

# Screen-like window splitting
unbind %
unbind '"'
bind S split-window -v          # Ctrl-a S (horizontal split, like screen)
bind | split-window -h          # Ctrl-a | (vertical split, like screen)

# Screen-like window management
bind c new-window               # Ctrl-a c (create window)
bind A command-prompt -I "#W" "rename-window '%%'"  # Ctrl-a A (rename window)
bind '"' choose-window          # Ctrl-a " (window list)

# Screen-like window navigation
bind space next-window          # Ctrl-a space (next window)
bind n next-window              # Ctrl-a n (next window)
bind p previous-window          # Ctrl-a p (previous window)
bind 0 select-window -t 0
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9

# Session management
bind d detach-client            # Ctrl-a d (detach)
bind k confirm-before -p "kill-window #W? (y/n)" kill-window  # Ctrl-a k (kill window)

# Copy mode + paste
bind [ copy-mode                # Ctrl-a [
bind ] paste-buffer             # Ctrl-a ]

# Pane navigation
bind tab select-pane -t :.+     # Ctrl-a Tab (cycle panes)

##### TERMINAL / TRUECOLOR / GHOSTTY #####

# Use tmux-256color for proper capabilities
set -g default-terminal "tmux-256color"

# Make sure truecolor works with xterm-256color / screen-256color / Ghostty
set -ga terminal-overrides ",xterm-256color:RGB,screen-256color:RGB,ghostty:RGB,tmux-256color:RGB"

# Focus events (neovim, etc)
set -g focus-events on

##### ENVIRONMENT / AGENT FORWARDING #####

# Make sure SSH agent env vars survive into panes
set -g update-environment "SSH_AUTH_SOCK SSH_AGENT_PID"

##### SCROLLBACK & PERFORMANCE #####

# Bigger history for travel / debugging
set -g history-limit 100000

# No delay for escape key press (good for vim)
set -g escape-time 0

# Don’t let tmux exit when last session ends
set -g exit-empty off

##### STATUS BAR / TITLES #####

# Terminal emulator window title
set -g set-titles on
set -g set-titles-string '#S:#I.#P #W'

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity on

# Status bar styling
set -g status-bg black
set -g status-fg white
setw -g window-status-current-style bg=red,fg=white

set -g status-left-length 40
set -g status-right-length 80
set -g status-interval 1

# Responsive status bar - uses tmux conditionals (no hooks/scripts)
# Wide (>=120): full info | Medium (80-119): compact | Narrow (<80): minimal
set -g status-left '#{?#{e|<|:#{client_width},80},#[fg=green]#S ,#[fg=green]#S #{prefix_highlight}» }'
set -g status-right '#{?#{e|<|:#{client_width},80},%I:%M,#{?#{e|<|:#{client_width},120},%m-%d %I:%M,#[fg=yellow]#h #[fg=white]%m-%d %I:%M}}'
setw -g window-status-format '#{?#{e|<|:#{client_width},80},#I, #I:#W }'
setw -g window-status-current-format '#{?#{e|<|:#{client_width},80},#I, #I:#W }'

# Pane borders & messages
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour39
set -g message-style bg=colour16,fg=colour166

##### INDEXING / RESIZE / RENAMING #####

# Start window & pane numbering at 1 (screen-like)
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# Aggressive resize is handy when you attach from multiple clients
setw -g aggressive-resize on

# Automatic window renaming
setw -g automatic-rename on
setw -g automatic-rename-format '#{b:pane_current_path}'

##### MOVEMENT & RESIZE KEYS (VI-LIKE) #####

# Pane navigation
bind h select-pane -L           # Ctrl-a h
bind j select-pane -D           # Ctrl-a j
bind k select-pane -U           # Ctrl-a k
bind l select-pane -R           # Ctrl-a l

# Pane killing
bind X kill-pane                # Ctrl-a X

# Pane resize
bind C-h resize-pane -L 5       # Ctrl-a Ctrl-h
bind C-j resize-pane -D 5       # Ctrl-a Ctrl-j
bind C-k resize-pane -U 5       # Ctrl-a Ctrl-k
bind C-l resize-pane -R 5       # Ctrl-a Ctrl-l

##### COPY MODE / CLIPBOARD (MACOS) #####

# Better copy mode (vi-style)
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi r send-keys -X rectangle-toggle

# Copy to tmux buffer only (fallback)
bind -T copy-mode-vi Y send-keys -X copy-selection-and-cancel

# Copy to macOS clipboard via pbcopy (primary)
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"

# Enable OSC 52 / clipboard integration where possible
set -g set-clipboard on

##### SESSION / WINDOW UTILITIES #####

bind s choose-session           # Ctrl-a s (session list)
bind $ command-prompt -I "#S" "rename-session '%%'"  # Ctrl-a $

# Quick window swapping
bind < swap-window -t -1\; select-window -t -1
bind > swap-window -t +1\; select-window -t +1

# More screen-like key bindings
bind ? list-keys                # Ctrl-a ? (help)
bind : command-prompt           # Ctrl-a :
bind a last-window              # Ctrl-a a (last window)
bind w choose-window            # Ctrl-a w
bind K kill-server              # Ctrl-a K (kill tmux server)
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

##### SHELL / DEFAULT COMMAND #####

# Let tmux use your login shell from /etc/passwd
# (safer than hardcoding something that might not exist in some environments)
# If you want to force zsh, uncomment:
# set -g default-command "/bin/zsh"

##### BELL HANDLING #####

set -g bell-action any
set -g visual-bell off

# 1) Pane scrollbars
set -g pane-scrollbars on
set -g pane-scrollbars-style "fg=brightblack,bg=default"

# 2) Respect terminal theme (Mode 2031)
# tmux will read the terminal's preference; wire this into your theme switch:
set -g status-style "bg=#{?@is_light,white,black},fg=#{?@is_light,black,white}"
# You can set @is_light via a small hook reading #{client_colours} or #{client_termfeatures}
# (tmux 3.6 exposes more term features for logic).



# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# set -g @plugin 'rose-pine/tmux'
#set -g @plugin 'wfxr/tmux-power'
#set -g @tmux_power_show_user    false
#set -g @tmux_power_theme 'violet'
#set -g @tmux_power_date_format '%b %-d'
#set -g @tmux_power_time_format '%I:%M '
#set -g @tmux_power_show_upload_speed  false 
#set -g @tmux_power_show_download_speed false
#set -g @tmux_power_prefix_highlight_pos 'LR'
#set -g @tmux_power_show_session false 

set -g @prefix_highlight_fg 'white' # default is 'colour231'
set -g @prefix_highlight_bg 'blue'  # default is 'colour04'

set -g @plugin 'tmux-plugins/tmux-prefix-highlight'


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'


source-file ~/.tmux.snazzy.theme
